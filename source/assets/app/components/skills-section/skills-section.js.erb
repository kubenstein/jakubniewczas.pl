angular.module('jakubniewczas')
  .directive('skillsSection',
    ['$rootScope', '$http', '$translate', '$location',
    function($rootScope, $http, $translate, $location) {

    return {
      scope: {},
      templateUrl: '<%= ng_template_url("skills-section/") %>',

      controller: ['$scope', function($scope) {
        function loadData() {
          $http.get('/api/v1/skills/'+ $translate.use() +'.json').then(function(response) {
            $scope.items = response.data;
          });
        }

        function initialize() {
          $rootScope.$on('$translateChangeSuccess', function() {
            loadData();
          });
          loadData();
        }
        initialize();

        $scope.displaySkillDetails = function(skill) {
          $location.path('/skill-'+ skill.id);
        }

      }]
    }
  }])