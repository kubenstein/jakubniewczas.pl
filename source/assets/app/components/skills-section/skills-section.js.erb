angular.module('jakubniewczas')
  .directive('skillsSection', ['$rootScope', '$http', '$translate', function($rootScope, $http, $translate) {

    return {
      scope: {
        name: '@',
        text: '@'
      },
      templateUrl: '<%= ng_template_url("skills-section/") %>',

      controller: ['$rootScope', '$scope', '$http', '$location', function($rootScope, $scope, $http, $location) {
        function loadData() {
          $http.get('/api/v1/skills/'+ $translate.use() +'.json').then(function(response) {
            $scope.items = response.data;
          });
        }

        function initialize() {
          $rootScope.$on('$translateChangeSuccess', function() {
            loadData();
          });
          loadData();
        }
        initialize();

        $scope.displaySkillDetails = function(skill) {
          $location.path('/skill-'+ skill.id);
        }

      }]
    }
  }])