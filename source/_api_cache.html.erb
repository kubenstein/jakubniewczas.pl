<script>
//
// fully removable data jsons and tempaltes preloader
// 
angular.module('jakubniewczas').run(['$http', '$cacheFactory', '$templateCache', function($httpProvider, $cacheFactory, $templateCache) {  
  $httpProvider.defaults.cache = true;
  httpCache = $cacheFactory.get('$http');
  <% sitemap.resources.select { |r| r.path.include?('.json') }.each do |json_file| %>
    httpCache.put("/<%= json_file.path %>", "<%= json_file.render.gsub('"', '\"') %>");
  <% end %>

  <% sitemap.resources.select { |r| r.path.include?('.tpl.html') }.each do |tpl_file| %>
    $templateCache.put("/<%= tpl_file.path %>", "<%= tpl_file.render.gsub('"', '\"') %>"); 
  <% end %>
}]);
</script>